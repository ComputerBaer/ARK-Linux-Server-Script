#!/bin/bash

# Version Checker 
version="1.0.0"

source ../version.ini
source ../version_game.ini
source ../configuration.ini
source formatting.ini

# Compare Script Versions
echo -e; echo -e "$YELLOW Checking version with github. $RESET"
if [ $version != $updatecheck ]; then
    echo -e " Script update available! (Update Check Script)"
    echo -e; echo -e "$YELLOW Downloading script file. $RESET"
    curl https://raw.githubusercontent.com/Zendrex/ARK-Linux-Server-Script/master/.serverscript/update_check -o update_check -#
    echo -e; echo -e "$GREEN File overwritten. Please restart the script. $RESET"
    exit 0
else
    echo -e " Up to date!"; echo -e
    sleep 1s
fi

# 
cd ../steamcmd
newVersion=$(./steamcmd.sh +login anonymous +app_info_print $gameid +quit | grep -o 'change number : \<[0-9]*\>' | grep -o '[0-9]*')

#
echo -e "Current Version:   $currentVersion"
echo -e "New Version:       $newVersion"

if [ $newVersion -gt $currentVersion ]; then
    echo "Update found!"
else
    echo "Up to date!"
fi

# 
cd ..
echo "currentVersion=$newVersion" > version_game.ini
